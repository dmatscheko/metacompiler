"Brainfuck"

<~~
function check() {
    if (data[dpos] == undefined) data[dpos] = 0
}

function next() {
    dpos++
}
function prev() {
    dpos--
}
function inc() {
    check()
    data[dpos]++
}
function dec() {
    check()
    data[dpos]--
}
function write() {
    check()
    printf("%c", data[dpos])
}
function read() {
    data[dpos] = 42 // Here we could get a char from the command line.
}
function lparen() {
    pushg(cpos)
}
function rparen() {
    check()
    if (data[dpos] == 0) { popg() } else { cpos = popg()-1 }
}

var data = []
var dpos = 0

// println("ASG: "+c.asg.Serialize())
c.compile(c.asg)

var cpos = 0
while (ltr.stack[cpos] != undefined) {
    // println(ltr.stack[cpos].name)
    // sleep(10)
    ltr.stack[cpos]()
    cpos++
}
~~>

{

Brainfuck = { Statement } ;
Statement = Opcode | Lparen { Statement } Rparen ;
Opcode = Next | Prev | Inc | Dec | Write | Read ;

Next = '>'          <~~ pushg(next) ~~> ;
Prev = '<'          <~~ pushg(prev) ~~> ;
Inc = '+'           <~~ pushg(inc) ~~> ;
Dec = '-'           <~~ pushg(dec) ~~> ;
Write = '.'         <~~ pushg(write) ~~> ;
Read = ',' | '?'    <~~ pushg(read) ~~> ;
Lparen = '['        <~~ pushg(lparen) ~~> ;
Rparen = ']'        <~~ pushg(rparen) ~~> ;

}
Brainfuck
